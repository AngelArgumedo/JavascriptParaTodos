
# 6. Asincronía en JavaScript

## ¿Qué es la Asincronía?

La asincronía en programación es la capacidad de un sistema para manejar múltiples tareas sin esperar a que cada una de ellas se complete antes de pasar a la siguiente. En otras palabras, permite que el programa continúe ejecutando código mientras espera que otras operaciones se completen (como llamadas a una API, temporizadores, o eventos de entrada/salida).

## ¿Por qué JavaScript usa la Asincronía?

JavaScript es un lenguaje de programación que se ejecuta en un solo hilo, lo que significa que solo puede hacer una cosa a la vez. Sin embargo, las aplicaciones modernas necesitan manejar múltiples tareas a la vez, como realizar solicitudes a un servidor o esperar la entrada del usuario. Para lograr esto sin bloquear la ejecución del programa, JavaScript utiliza la asincronía.

Al ser asincrónico, JavaScript puede ejecutar múltiples tareas de manera simultánea, lo que permite a los programas realizar operaciones más eficientes y escalables.
1. **Mejorar el rendimiento**: Permite que el programa responda a los eventos sin necesidad de esperar a que una tarea termine antes de iniciar otra.
2. **Evitar bloqueos**: Mantiene la aplicación fluida y receptiva, especialmente en operaciones que pueden tomar tiempo, como solicitudes de red.

## ¿Cómo trabaja JavaScript con la Asincronía?

JavaScript utiliza diferentes métodos para manejar la asincronía:
1. **Callbacks**: Funciones que se pasan como argumentos a otras funciones para que se ejecuten una vez que una tarea se completa.
2. **Promises**: Objetos que representan el eventual resultado (o error) de una operación asíncrona.
3. **Async/Await**: Una forma moderna de manejar la asincronía que hace que el código se vea más sencillo y parecido a código sincrónico.

---
# 1. Callbacks

## ¿Qué son Callbacks?
Un callback es una función que se pasa como argumento a otra función para que se ejecute después de que la tarea inicial se complete. Los callbacks son una de las formas más antiguas y comunes de manejar la asincronía en JavaScript.

Ejemplo de un Callback:

```javascript
function descargarArchivo(url, callback) {
  console.log(`Descargando archivo de ${url}...`);
  setTimeout(() => {
    console.log("Archivo descargado.");
    callback(); // Ejecutar el callback después de que la descarga termine
  }, 2000);
}

function mostrarMensaje() {
  console.log("¡Descarga completada!");
}

descargarArchivo("https://example.com/archivo.zip", mostrarMensaje);
```
En este ejemplo, `descargarArchivo` simula la descarga de un archivo que toma 2 segundos. Una vez que se completa, ejecuta el `callback`, que es la función `mostrarMensaje`.

---
>[!NOTE]
> ¿Cómo se usan los Callbacks?
> Los callbacks son especialmente útiles para:
> - Ejecutar código después de una operación asíncrona: Por ejemplo, mostrar un mensaje después de descargar un archivo.
> - Estructurar código de eventos: Como el manejo de clics del usuario o respuestas de servidores.
> - Encadenar operaciones: Realizar tareas en secuencia una vez que cada tarea previa se haya completado.

### Representación Gráfica del Flujo Asíncrono con Callbacks

```plaintext

Inicio del Programa
       |
       v
+---------------------+
| Llamar Función      |  <--- Se inicia la función que contiene la tarea asíncrona
| Asíncrona           |
+---------------------+
       |
       v
+---------------------+
|   Iniciar Tarea     |  <--- Tarea asíncrona (ej. solicitud a un servidor)
|   Asíncrona         |
+---------------------+
       |
       v
+---------------------+
|    Esperar          |  <--- El programa continúa ejecutando otras tareas
|    (No Bloquea)     |       mientras espera que se complete la tarea asíncrona.
+---------------------+
       |
       v
+---------------------+
| Ejecutar Callback   |  <--- Una vez que la tarea asíncrona finaliza,
| (Tarea Completada)  |       se ejecuta la función callback.
+---------------------+
       |
       v
Continuar con el Programa

```
---

### Callback Hell

Aunque los callbacks son útiles, pueden llevar a un problema conocido como "callback hell" si se anidan demasiados callbacks uno dentro del otro, lo que hace que el código sea difícil de leer y mantener.

Ejemplo de Callback Hell:

```javascript
function tarea1(callback) {
  setTimeout(() => {
    console.log("Tarea 1 completada.");
    callback();
  }, 1000);
}

function tarea2(callback) {
  setTimeout(() => {
    console.log("Tarea 2 completada.");
    callback();
  }, 1000);
}

function tarea3(callback) {
  setTimeout(() => {
    console.log("Tarea 3 completada.");
    callback();
  }, 1000);
}

// Callbacks anidados (Callback Hell)
tarea1(() => {
  tarea2(() => {
    tarea3(() => {
      console.log("Todas las tareas completadas.");
    });
  });
});
```

Representacion grafica del callback hell:

```plaintext
Inicio del Programa
       |
       v
+--------------------------+
|    Ejecutar tarea1()     |  <--- Se llama a la primera función
+--------------------------+
       |
       v
+--------------------------+
|  Esperando 1 segundo...  |  <--- Tarea asíncrona (setTimeout)
+--------------------------+
       |
       v
+--------------------------+
|  "Tarea 1 completada."   |  <--- Tarea 1 termina y se ejecuta el callback
|   Ejecutar tarea2()      |  <--- Dentro del callback de tarea1 se llama a tarea2
+--------------------------+
       |
       v
+--------------------------+
|  Esperando 1 segundo...  |  <--- Tarea asíncrona (setTimeout)
+--------------------------+
       |
       v
+--------------------------+
|  "Tarea 2 completada."   |  <--- Tarea 2 termina y se ejecuta el callback
|   Ejecutar tarea3()      |  <--- Dentro del callback de tarea2 se llama a tarea3
+--------------------------+
       |
       v
+--------------------------+
|  Esperando 1 segundo...  |  <--- Tarea asíncrona (setTimeout)
+--------------------------+
       |
       v
+--------------------------+
|  "Tarea 3 completada."   |  <--- Tarea 3 termina y se ejecuta el callback
| "Todas las tareas        |
|  completadas."           |  <--- Mensaje final del callback de tarea3
+--------------------------+
       |
       v
Continuar con el Programa

```

Para evitar el "callback hell", se recomienda usar promesas y async/await, que son más legibles y fáciles de mantener.

---

> [!TIP]
> Los callbacks son fundamentales para manejar la asincronía en JavaScript. Permiten ejecutar funciones después de que otras tareas se completen, lo que mantiene las aplicaciones receptivas y eficientes. Aunque los callbacks son efectivos, es importante usarlos con cuidado para evitar el "callback hell" y considerar otras alternativas más modernas como las promesas y async/await para manejar flujos de trabajo más complejos.

---

**[↩️ Regresar al índice](../README.md)**