
# 3. Async/Await

## ¿Qué es Async/Await?
Async/Await es una sintaxis moderna en JavaScript que facilita el trabajo con código asíncrono. Permite escribir código asíncrono que se lee de manera más similar a código sincrónico, haciendo que sea más claro y fácil de entender. Internamente, async/await sigue funcionando con promesas, pero simplifica el manejo de tareas asíncronas.

---
### ¿¿Cómo funciona?
- **async**: Se coloca antes de una función para que esta devuelva una promesa automáticamente.
- **await**: Pausa la ejecución de la función `async` hasta que la promesa se resuelva. Se utiliza para esperar el resultado de una promesa antes de continuar con la siguiente línea de código.

Ejemplo de Uso de Async/Await:
```javascript
function descargarArchivo() {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const exito = true; // Cambia para probar el caso de error
      if (exito) {
        resolve("Archivo descargado exitosamente.");
      } else {
        reject("Hubo un problema al descargar el archivo.");
      }
    }, 2000);
  });
}

async function iniciarDescarga() {
  try {
    const mensaje = await descargarArchivo();
    console.log(mensaje);
  } catch (error) {
    console.error(error);
  }
}

iniciarDescarga();

```

Representacion de la ejecucion del código:
```plaintext

    Inicio del Programa
             |
             v
+-------------------------------+
|   Ejecutar iniciarDescarga()  |
+-------------------------------+
             |
             v
+-------------------------------+
|  Llamar a descargarArchivo()  |  <--- Función asíncrona llamada con await
+-------------------------------+
             |
             v
+-------------------------------+
|   Esperar 2 segundos...       |  <--- Pausa mientras se ejecuta setTimeout
+-------------------------------+
             |
             v
+-------------------------------+
|   Comprobar condición `exito` |  
|   ¿exito === true?            | 
+-------------------------------+
   |                        |
   | Sí                     | No
   v                        v
+------------------+   +------------------+
|   resolve()      |   |   reject()       |
| "Archivo         |   | "Hubo un         |
|  descargado..."  |   |  problema..."    |
+------------------+   +------------------+
   |                                |
   v                                v
+-----------------------------+   +-----------------------------+
| Continuar ejecución         |   | Capturar error en catch     |
| Mostrar mensaje en console  |   | Mostrar mensaje de error    |
+-----------------------------+   +-----------------------------+
                    |
                    v
        Continuar con el Programa

```
---
>[!NOTE]
> ¿Por qué usar Async/Await?
> - Código más limpio y legible: Async/await evita el anidamiento excesivo que a menudo se presenta con los callbacks y mejora la legibilidad en comparación con el uso directo de promesas.
> - Manejo de Errores Simplificado: Con try/catch, es fácil manejar errores dentro de funciones asíncronas, de manera similar a cómo se haría en código sincrónico.
> - Encadenamiento de Promesas más Claro: No necesitas múltiples .then(), lo que simplifica la secuencia de tareas asíncrona

---
Comparación:

usando Promesas:
```javascript
descargarArchivo()
  .then(mensaje => {
    console.log(mensaje);
    return otraOperacion();
  })
  .then(resultado => {
    console.log(resultado);
  })
  .catch(error => {
    console.error(error);
  });
```

usando Async/Await:
```javascript
async function procesarTareas() {
  try {
    const mensaje = await descargarArchivo();
    console.log(mensaje);
    const resultado = await otraOperacion();
    console.log(resultado);
  } catch (error) {
    console.error(error);
  }
}

procesarTareas();
```

---
### Ejecución Concurrente con Async/Await
Aunque await detiene la ejecución dentro de una función async, podemos ejecutar múltiples operaciones asíncronas de manera concurrente usando Promise.all(). Esto permite esperar que todas las promesas se resuelvan antes de continuar.

Ejemplo:
```javascript
async function obtenerDatos() {
  const promesa1 = fetch("https://jsonplaceholder.typicode.com/todos/1");
  const promesa2 = fetch("https://jsonplaceholder.typicode.com/todos/2");

  const [respuesta1, respuesta2] = await Promise.all([promesa1, promesa2]);

  const datos1 = await respuesta1.json();
  const datos2 = await respuesta2.json();

  console.log(datos1, datos2);
}

obtenerDatos();
```
---
### Representación Gráfica

```plaintext

+-----------------------+
|   Función Async       |
+-----------------------+
| await operación       |
+-----------------------+
       |
       v
  Pausa hasta que se resuelva la Promesa
       |
       v
 Continuar con el resto del código

```
---

> [!TIP]
> Async/Await es una herramienta poderosa que simplifica el manejo de tareas asíncronas en JavaScript. Al usarla, el código se vuelve más limpio, más fácil de leer y mantener. Aprender a usar async/await correctamente es fundamental para trabajar con operaciones asíncronas de forma eficiente.

---

**[↩️ Regresar al índice](../README.md)**